<!DOCTYPE html>
<html lang="ru">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta charset="UTF-8">
    <title>Глава 2. Прикладной уровень сетей</title>
<!--    Подключение матджакса(латекс-формул)-->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" type="text/css" href="../styles/styles.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../modules/jquery-3.7.1.min.js"><'+'/script>')</script>
    <script src="../scripts/body_scripts.js"></script>
    <script src="../common/counters_head.js"></script>
</head>
<body>
<script src="../common/counters_body.js"></script>
<h1>Глава 2. Прикладной уровень сетей</h1>

<h2>Принципы сетевых приложений</h2>
<p>Ключевую часть разработки сетевых приложений составляет написание программ, которые работают на различных конечных системах и общаются друг с другом по сети. Например, <b>веб-приложение</b> — это две различные программы, взаимодействующие друг с другом: <b>браузер</b>, запущенный на хосте пользователя (настольном компьютере, ноутбуке, планшете, смартфоне и так далее), и <b>веб-сервер</b>, работающий на серверном хосте.</p>
<p>Другой пример — это одноранговые системы совместного доступа к файлам, где на каждом из хостов, который участвует в файловом обмене, запущена такая программа. В этом случае программы на различных хостах могут быть аналогичными или даже идентичными.</p>
<p>Важно отметить здесь, что вам не нужно писать программное обеспечение для устройств, составляющих ядро сети, таких как маршрутизаторы или коммутаторы канального уровня. Но даже если бы вы и задались такой целью, вы бы не смогли это сделать, т.к. данные устройства функционируют не на прикладном уровне, а на сетевом и более низких уровнях</p>

<h3>Архитектура сетевых приложений</h3>
<p>С точки зрения разработчика приложения, архитектура сети постоянна и предлагает определенный набор служб приложениям. С другой стороны, <b>архитектура приложения</b> создается разработчиком этого приложения и определяет, каким образом оно будет строиться на различных конечных системах. Выбирая архитектуру приложения, разработчик, скорее всего, выберет одну из двух доминирующих архитектурных парадигм, используемых в современной разработке сетевых приложений: <b>клиент-серверная</b> или <b>одноранговая</b> (P2P).</p>
<p><b>Доминирующие архитектурные парадигмы для сетевых приложений:</b></p>
<ul>
    <li><b>Клиент-серверная</b>: существует 1 хост (сервер), который постоянно находится онлайн и обслуживает запросы от других хостов (клиентов). Когда веб-сервер получает запрос объекта от хоста-клиента, он в ответ отправляет запрашиваемый объект этому хосту. Заметим, что в данном виде архитектуры клиенты непосредственно не связываются друг с другом; например, в веб-приложении два браузера напрямую не обмениваются информацией. Еще одной характеристикой клиент-серверной архитектуры является то, что сервер имеет фиксированный, известный всем адрес, называемый IP-адресом (обсудим вскоре). Поскольку сервер имеет постоянный, известный адрес и всегда включен, клиент может всегда взаимодействовать с ним, отправляя пакеты на IP-адрес этого сервера. <br>Некоторые из хорошо известных приложений клиент-серверной архитектуры — это <i>Всемирная паутина</i>, <i>FTP</i>, <i>Telnet</i> и <i>электронная почта</i>.  </li>
    <li><b>Одноранговая (P2P)</b> - архитектура, в которой применение серверов или центров обработки сведено до минимума или вообще до нуля. Вместо них приложения используют непосредственное взаимодействие между парой соединенных хостов, называемых пирами (также партнерами или узлами). Пирами являются обычные ПК. Т.к. они взаимодействуют без выделенного сервера, такая архитектура называется одноранговой (<i>peer-to-peer</i>). Примеры - файлообменные приложения, ускорители загрузок, IP-телевидение. </li>
</ul>
<img src="images/p2p.png" alt="">
<p>Преимуществом одноранговой архитектуры является ее самомасштабируемость, т.к. вычислительные/накопительные мощности системы растут по мере роста аудитории. </p>
<p>Проблемы одноранговой архитектуры:</p>
<ol>
    <li>Адаптация к сетям доступа. Большинство сетей доступа (DSL и кабельные сети) построены по ассиметричному принципу, т.е. скорость входящего трафика значительно превышает скорость исходящего. Поскольку P2P-приложения для обработки видео от ссерверов к сетям доступа смещают исодящий трафик от серверов к сетям доступа, то нагрухка на них значительно возрастает. </li>
    <li>Безопасность. </li>
    <li>Стимулирование юзеров к вкладу в P2P-сеть./li>
</ol>
<h3>Взаимодействие процессов</h3>
<p>Процесс - программа, запущенная на конечной системе. Когда процессы работают на одном хосте, то они взаимодействуют друг с другом с помощью средств межпроцессного взаимодествия. Как же взаимодестйвуют процессы на разных хостах?</p>
<p> <i>Процессы на двух хостаз взаимодествуют друг с другом обмениваясь сообщениями через сеть. Например, в веб-приложении процесс браузера клиента обменивается сообщениями с процессом веб-сервера. В случае P2P файлообменной сети процесс одного хоста преедает файл в процесс другого хоста.</i></p>
<p><i>В контексте сеанса взаимодествия между парой процессов тот, который инициирует взаимодествие (т.е. первым контактирует с другим процессом в начале сеанса), обозначается как <b>клиентский</b>.</i></p>
<p>Процесс, который ожидает контакта для начала сеанса, называется <b>серверными</b>.</p>
<h4>Интерфейс между процессом и компьютерной сетью</h4>
<p>Процессы отправляют и принимают сообщения через программный интерфейс, называемый <b>сокетом</b>. Рассмотрим аналогию для лучшего понимания процессов и сокетов. Процесс аналогичен дому, а его сокет подобен двери в этом доме. Когда процесс пытается отправить сообщение другому процессу на удаленном хосте, он «проталкивает» сообщение через свою дверь (сокет). Такая отправка предполагает, что с другой стороны этой двери существует некоторая транспортная инфраструктура, которая организует доставку сообщения до двери процесса назначения. Когда сообщение прибывает на хост назначения, оно проходит через дверь принимающего процесса (через сокет). Принимающий процесс затем обрабатывает это сообщение.</p>
<p>Сокет - это API между сетевыми приложениями и сетью (протоколом транпортного уровня).</p>
<img src="images/sockets.png" alt="">
<p>Разработчик управляет всем, что находится на прикладном уровне сокета, но со стороны транспортного уровня он управляет лишь:</p>
<ul>
    <li>выбор транспортного протокола</li>
    <li>возможность фиксации параметров транспортного уровня (например, максимальный буфер и максимальный размер сегмента)</li>
</ul>
<h4>Адресация процессов</h4>
<p>Когда запущенный на одном хосте процесс пытается отправить пакеты процессу, работающему на другом хосте, то необходимо знать адрес второго процесса. Для идентификации процесса-получателя необходима информация о двух вещах:</p>
<ol>
    <li>Адрес хоста назначения. Это IP-адрес</li>
    <li>Идентфикатор процесса на хосте назначения. ID открыторого принимающего веб-сокета запушенного на хосте-получаетле. Номер порта решает эту проблему</li>
</ol>
<h3>Транспортные службы, доступные приложениям</h3>
<p>Критерии выбора транспортного протокола</p>
<ul>
    <li>Надежная передача данных. Потеря данных может иметь место во многих приложения, например, электроннаяя почта, передача файлов, удаленный доступ и т.д. Если протокол обеспечивает гарантированную службу доставки, то говорят, что обеспечивается надежная передача данных. Приложения, для которых потеря некоторого объема данных некритична, называются устойчивыми к потерям данных. </li>
    <li>Пропускная способность - скорость, с которой передающий процесс может доставлять биты принимающему процессу. Приложения, которые требует некоторой минимальной пропускной способности называются чувствительными к скорости передачи. В тоже время эластичные приложения используют доступнуб пропускную способность. К таким приложениям относятся электронная почта, передача файлов, веб-приложения. </li>
    <li>Время доставки. Транспортным протоколом может также гарантироваться миниматальное относительное время доставки. Например, протокол может гарантировать, что каждый бит, отправленный передающей сторонной в сокет, приходит на сокет получаетеля не более через 100мс. Примерами приложения, для которых обоснована такая гарантия - это IP-телефония, виртуальное окружения, телеконференции, а также многопользователтские игры. </li>
    <li>Безопасность. Например, транспортный протоколо на передающем хосте способен шифровать все данные, отправленные процессом источником, а затем на принимающем хосте расшифровывать их пред доставкой процессу получателю. </li>
</ul>
<h3>Транспортные средства, предоставляемые интернетом</h3>
<p>TCP/IP-сети предоставляют приложениям 2 транспортных протокола - UDP и TCP. </p>
<h4>Службы протокола TCP</h4>
<p>TCP (Transmission Control Protocol) - это один из основных протоколов передачи данных интернета. Модель обслуживания протокола TCP включает службу установления логического соединения и службу надежной передачи данных </p>
<p>Ниже приведены требования к службам, предъявляемые определенными сетевыми приложениями:</p>
<style>
    .first-column-table tr td:first-of-type {
        background: wheat;
    }
</style>
<table class='first-column-table'>
    <tr>
        <th>Приложение</th>
        <th>Потери данных</th>
        <th>Пропускная способность</th>
        <th>Чувствительность к потере данных</th>
    </tr>
    <tr>
        <td>Передача файлов/загрузка</td>
        <td>Не допускаются</td>
        <td>Эластичная</td>
        <td>Нет</td>
    </tr>
    <tr>
        <td>Электронная почта</td>
        <td>Не допускаются</td>
        <td>Эластичная</td>
        <td>Нет</td>
    </tr>
    <tr>
        <td>Веб-документы</td>
        <td>Не допускаются</td>
        <td>Эластичная (несколько Кбит/<br>с)</td>
        <td>Нет</td>
    </tr>
    <tr>
        <td>IP-телефония/Видео-конференции</td>
        <td>Допускаются</td>
        <td><ul>
            <li>Аудио: от нескольких Кбит/с до 1 Мбит/с</li>
            <li>Видео: от 10 Кбит/с до 5 Мбит/с</li>
        </ul></td>
        <td>Да, сотни миллисекунд</td>
    </tr>
    <tr>
        <td>Потоковый аудио и видеоконтент</td>
        <td>Допускаются</td>
        <td>
            <ul>
                <li>Аудио: от нескольких Кбит/с до 1 Мбит/с</li>
                <li>Видео: от 10 Кбит/с до 5 Мбит/с</li>
            </ul>
        </td>
        <td>Да, нексколько миллисекунд</td>
    </tr>
    <tr>
        <td>Интерактивные игры</td>
        <td>Допускаются</td>
        <td>От нескольких до 10 Кбит/с</td>
        <td>Да, сотни миллисекунд</td>
    </tr>
    <tr>
        <td>Мгновенные сообщения</td>
        <td>Не допускаются</td>
        <td>Эластичная</td>
        <td>Да и нет</td>
    </tr>
</table>
<p><i>Передача с установлением соединения</i>. Происходит <b>рукопожатие</b> между клиентом и сервером. Протокол TCP обеспечивает обмен управляющей информацией между клиентом и сервером на транспортном уровне. Это дает клиенту и серверу возможность подготовиться к началу обмена. В итоге между сокетами клиентского и серверного процессов устанавливается <b>TCP-соединение</b>. Это соединение является дуплексным, т.е. оба процесса могут передавать данные друг другу в одно и то же время. Когда приложение завершит передачу, то соединение будет разорвано. </p>
<p><i>Надежная передача данных</i>. Процессы взаимодействующие по протоколу TCP могут быть уверены, что данные будут доставлены без ошибок и в строго определенном порядке. </p>
<p><i>(Не)безопасноть протокола TCP</i>. TCP и UDP не предоставляют службы шифрования передаваемых данных. Отправленные передающим процессом данные в сокет принимающего процесса идентичны как на этапе отправления, так и на этапе доставки. Так, например, текстовый пароль будет переходить все линии связи на пути от отправителя к получателю и потому может стать уязвимым для перехвата. </p>
<p>Соображения по поводу небезопасности TCP навели сообщество на разработку криптографического протокола SSL (Secure Sockets Layer), или уровеня защищенных сокетов, как доработку протокола TCP. TCP+SSL обеспечивает шифрование, контроль целостности данных и конечную аутентификацию. </p>
<ol>
    <li>Передающий процесс передает незашифрованные данные в свой SSL-сокет</li>
    <li>SSL-cокет на передающем хосте шифрует дынные и передает их в TCP-сокет </li>
    <li>TCP-сокет отправляет зашифрованные данные по сети в TCP-сокет принимающей стороны</li>
    <li>TCP-сокет принимающей стороны отправляет зашифрованные данные в SSL-сокет</li>
    <li>SSL-сокет принимающей стороны расшифровывает данные и посылает данные в принимающий процесс.</li>
</ol>

<h4>Службы протокола UDP</h4>
<p>UDP представляет собой простой протокол транспортного уровня,
    предлагающий минимальный набор служб. UDP является протоколом
    без установления соединения, то есть процедуры рукопожатия перед
    тем, как два процесса начинают взаимодействовать, не происходит.
    UDP обеспечивает ненадежную передачу данных — другими словами,
    когда процесс отправляет сообщение в сокет UDP, нет никакой гарантии, что сообщение будет получено принимающим процессом. Более
    того, сообщения могут поступать в принимающий процесс в произвольном порядке.</p>
<h3>Службы, не предоставляемые транспортными протоклами Интернета</h3>
<p>В таблице ниже показаны популярные транспортные протоколы.</p>
<table>
    <tr>
        <th>Приложение</th>
        <th>Протокол прикладного уровня</th>
        <th>Базовый транспортный протокол</th>
    </tr>
    <tr>
        <td>Электронная почта</td>
        <td>SMTP</td>
        <td>TCP</td>
    </tr>
    <tr>
        <td>Удаленный терминальный доступ</td>
        <td>Telnet</td>
        <td>TCP</td>
    </tr>
    <tr>
        <td>Всемирная паутина</td>
        <td>HTTP</td>
        <td>TCP</td>
    </tr>
    <tr>
        <td>Передача файлов</td>
        <td>FTP</td>
        <td>TCP</td>
    </tr>
    <tr>
        <td>Потоковый мультимедийный контент</td>
        <td>HTTP</td>
        <td>TCP</td>
    </tr>
    <tr>
        <td>IP-телефония</td>
        <td>SIP, RTP или проприетарное</td>
        <td>UDP или TCP</td>
    </tr>
</table>
<p>Как несложно заметить, абсолютное большинство приложений используют TCP в качестве своего базового транспортного протокла. Это свяазно с тем, что он обеспечивает надежную передачу данных, гарантируя что вс еданные в итоге доберуться до получаетлся в целостности и сохранности. </p>
<p>Исключением является IP-телефония, которая допускает некоторые потери данных, но требуют для своей работы некоторого минимальной скорости передачи, поэтому разработчики обычно предпочитают UDP, избегая тем самым механизма управления перегрузкой и дополнительных затрат на гарантированную доставку пакетов, присущих протоколу TCP. Возможность TCP всключается как резерв на всякий случай, т.к. многие брандмауэры настроены на блокировку UDP-трафика</p>
<h2>Протоколы прикладного уровня</h2>
<p>ПротоколЫ прикладного уровня, которые определяют как прикладные
    процессы, запущенные на различных конечных системах, передают друг
    другу сообщения. В частности, протокол прикладного уровня определяет:</p>
<ol>
    <li>Типы сообщений, которыми обмениваются процессы, например сообщения запроса или сообщения ответа</li>
    <li>Синтаксис различных типов сообщений, то есть состав полей сообщения и их порядок</li>
    <li>Семантика полей, то есть значение информации, содержащейся
        в каждом из них</li>
    <li>Набор правил для определения времени и порядка передачи сообщений и получения ответов</li>
</ol>
<p>Общедоступные протоколы описаны в документах RFC. Таким образом, если разработчик браузера следует правилам RFC по поводу протокла HTTP, то он будет способен в этом браузере загрузить любую веб-страницу, сервер которой соответсвует правилам RFC по поводу протокла HTTP. </p>
<p>Заметим разницу между понятиями сетевого приложения и протокола прикладного уровня.</p>
<ul>
    <li>Всемирная путина - сетевое приложене, котороое позволяет юзерам получать документы с веб-сервера по запроса. Веб-приложение включает стандартны для форматов документов (HTML), веб-браузеров, веб-серверов (например, Apache) и протокола прикладного уровня</li>
    <li>Протокол для всемирной паутины прикладного уровня - HTTP - определяет формат и последовательность сообщений, которыми обмениваются браузер и сервер. </li>
</ul>
<p></p>
<p></p>
<p></p>
<p></p>
<p></p>

</body>
</html>